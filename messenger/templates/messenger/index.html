<!--
 [Messenger] INDEX.HTML - Copyright (c) 2016 - Sean Bailey - All Rights Reserved
 Powered by Django (https://www.djangoproject.com/) - Not endorsed by Django

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

 Looking for source code? Check it out here: https://github.com/LuckehPickle/chat
-->
<!DOCTYPE html>
<html>
    <head>
        <title>{{ title }}</title>
        {% load staticfiles %}
        <meta charset="UTF-8">
        <meta name="theme-color" content="#3B3B3B">
        <meta name="msapplication-navbutton-color" content="#3B3B3B">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
        <link rel="icon" type="image/ico" href="{% static 'shared/favicon.ico' %}">
        <link href="{% static 'messenger/css/main.css' %}" type="text/css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script src="//use.edgefonts.net/bebas-neue:n4.js"></script>
        {% load socketio_tags %}
        {% socketio %}
        <script>
            {% if group_id != None %}window.group_id = "{{ group_id }}";{% else %}window.group_id = null;{% endif %}
            {% if user_url != None %}window.user_url = "{{ user_url }}";{% else %}window.urser_url = null;{% endif %}
        </script>
    </head>
    <body>
        {% load messenger_tags %}
        <script src="{% static 'shared/js/mo.min.js' %}"></script>
        {% include 'shared/push-messages.html' %}
        {% include 'shared/nav.html' %}

        <!-- Modals -->
        <div class="modal-wrapper">
            {% include 'messenger/create.html' %}
        </div>

        <!-- Toolbar -->
        <div class="toolbar">
            <div class="mobile-tools">
                <i class="material-icons js-transit" data-transit-id="m-back">chevron_left</i>
                <p>This is a really long title</p>
                <i class="material-icons js-transit" data-transit-id="m-add_user">person_add</i>
                <i class="material-icons js-transit dropdown-trigger" data-transit-id="m-more" data-mobile id="more">more_vert</i>
                {% comment %}
                <ul class="dropdown">
                    <li><a href="/"><i class="material-icons">photo</i>Edit chat picture</a></li>
                    <li><a href="/"><i class="material-icons">title</i>Edit chat name</a></li>
                    <li><a href="/"><i class="material-icons">group</i>Edit participants</a></li>
                    <li><a href="/"><i class="material-icons">link</i>Get URL</a></li>
                    <li><a href="/"><i class="material-icons">gavel</i>Manage moderators</a></li>
                    <li><a href="/"><i class="material-icons">gavel</i>View commands</a></li>
                    <li><a href="/"><i class="material-icons">exit_to_app</i>Leave chat</a></li>
                </ul>
                {% endcomment %}
            </div>

            <!-- DESKTOP TOOLS -->
            <div class="desktop-tools">
                <i class="material-icons js-transit create-group-trigger" data-transit-id="create-chat">add</i>
                <!-- SEARCH -->
                <div class="tools-input-wrapper">
                    <i class="material-icons noselect">search</i>
                    <input type="text" spellcheck="false" placeholder="Search...">

                    <!-- DROPDOWN -->
                    <div class="tools-input-dropdown">
                        <section class="dropdown-users">
                            <p class="dropdown-title">Users</p>
                            <p class="dropdown-no-results">No results found.</p>
                        </section>
                        <section class="dropdown-pages">
                            <p class="dropdown-title">Docs</p>
                            <p class="dropdown-no-results">No results found.</p>
                        </section>
                        <section>
                            <a class="dropdown-silent">
                                See all results
                                <link class="rippleJS">
                            </a>
                        </section>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Wrap -->
        <div class="chat-wrap">
            <div class="chat-area">

                <div class="chat-area-left">
                    <!-- TABS HEAD -->
                    <div class="tab-heads">
                        <!-- TODO Store active tab in cookes -->
                        <div class="tab-head noselect" data-tab="friends" {% if not is_group %}active{% endif %}>Friends</div>
                        <div class="tab-head noselect" data-tab="groups" {% if is_group %}active{% endif %}>Groups</div>
                    </div>

                    <!-- FRIENDS LIST -->
                    <div class="tab-body tab-friends" {% if not is_group %}active{% endif %}>
                        {% if request.user.friends.count != 0 %}
                            {% for friend in request.user.friends.all|sort_by:"-is_online" %}
                                <div class="friend-container" data-url="{{ friend.get_absolute_url }}" {% if not is_group and user_url == friend.user_url %}active{% endif %}>
                                    <div class="friend-image"></div>
                                    <div>
                                        <p class="friend-username">{{ friend.username }} {% comment "TODO" %}{{ friend.nickname }}{% endcomment %}</p>
                                        <p class="friend-tag">Beta-Tester</p> <!-- TODO Allow custom tags -->
                                    </div>
                                    <div class="friend-status-{% if friend.is_online %}online{% else %}offline{% endif %}"></div>
                                    <link class="rippleJS"/>
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="no-friends">You don't have any friends yet. TODO Make this look fancy, and add a tip on how to add a friend.</div>
                        {% endif %}
                    </div>

                    <!-- GROUPS LIST -->
                    <div class="tab-body tab-groups" {% if is_group %}active{% endif %}>
                        {% if request.user.groups.count != 0 %}
                            {% for group in request.user.groups.all|sort_by:"-last_message" %}
                                <div class="group-container" data-url="{{ group.get_absolute_url }}" {% if is_group and group_id == group.group_id %}active{% endif %}>
                                    <div class="group-image"></div>
                                    <div>
                                        <p class="group-name">{{ group.name }}</p>
                                        <p class="group-message">Placeholder message for now. Really long too.</p>
                                    </div>
                                    <link class="rippleJS"/>
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="no-groups">You don't have any friends yet. TODO Make this look fancy, and add a tip on how to add a friend.</div>
                        {% endif %}
                    </div>
                </div>

                <!-- List of chats
                <div class="chat-list">
                    <div class="chat-item active">
                        <div class="chat-item-image"></div>
                        <div class="chat-item-wrapper">
                            <p class="chat-item-title">This is a really long title</p>
                            <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                        </div>
                    </div>
                    <div class="chat-item">
                        <div class="chat-item-image"></div>
                        <div class="chat-item-wrapper">
                            <p class="chat-item-title">Hello World</p>
                            <p>Proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        </div>
                    </div>
                </div>-->

                <!-- Chat -->
                <div class="chat">
                    <!-- Chat Body -->
                    <div class="chat-body">
                        <!--<div class="chat-message-container-other">
                            <div class="chat-message-image-other"></div>
                            <span class="triangle-top-right"></span>
                            <div class="chat-message-content-other">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</div>
                        </div>

                        <div class="chat-message-container">
                            <div class="chat-message-image"></div>
                            <span class="triangle-top-left"></span>
                            <div class="chat-message-content">Proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</div>
                        </div>

                        <div class="chat-message-container-tag">
                            <div class="chat-message-content">Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</div>
                        </div>-->
                    </div>

                    <!-- Chat Footer -->
                    <div class="chat-footer">
                        <form id="chat-form" novalidate{% if group_id == None and user_url == None %} disabled{% endif %}>
                            <input id="chat-message" name="name" type="text" maxlength="256" placeholder="Send message">
                            <div class="chat-send">
                                <i class="material-icons">send</i>
                                <link class="rippleJS"/>
                            </div>
                            <input type="submit"><!-- Hidden, allows users to press 'enter' -->
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Compressed Footer -->
        <div class="compact-footer">
            <div>Copyright © 2016 - Sean Bailey - All Rights Reserved</div>
        </div>

        <script src="{% static 'shared/js/nav.js' %}"></script>
        <script src="{% static 'shared/js/jquery-2.2.2.min.js' %}"></script>
        <script src="{% static 'messenger/js/messenger.js' %}"></script>
        <script src="https://cdn.rawgit.com/samthor/rippleJS/v1.0.2/ripple.min.js"></script>
    </body>
</html>
