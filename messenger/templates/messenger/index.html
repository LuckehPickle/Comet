{% extends 'shared/base.html'|pjax:request %}

{% load staticfiles %}
{% block title %}{{ title }}{% endblock %}
{% block extra_css %}<link href="{% static 'messenger/css/messenger.css' %}" type="text/css" rel="stylesheet">{% endblock %}
{% block extra_js %}<script src="{% static 'messenger/js/messenger.js' %}"></script>{% endblock %}

{% load messenger_tags %}

{% block modals %}
<div class="modal-create modal">
    <p class="modal-title">Create Group</p>

    {# Modal Form TODO Rewrite form without Django #}
    <form action="{% url 'create' %}" method="post" novalidate>
        {% csrf_token %}

        <div class="modal-input-container">
            <p>Group Name</p>
            <div><input id="id_name" maxlength="32" name="name" type="text" /></div>
        </div>

        <div class="modal-checkbox-container">
            <input id="id_is_public" name="is_public" type="checkbox" />
            <label for="id_is_public" class="noselect">Make this group public</label>
        </div>

        {# Modal Button Wrapper #}
        <div class="modal-button-wrapper">
            <input type="submit" value="Create">
            <div class="modal-silent-button noselect modal-create-cancel">
                Cancel
                <link class="rippleJS"/>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block content %}
    <script>
        {% if channel_id != None %}
            window.channel_id = "{{ channel_id }}";
            window.is_group = {{ is_group|yesno:"true,false" }};
        {% else %}
            window.channel_id = null;
        {% endif %}
    </script>

    {# Wrapper #}
    <div class="messenger-wrapper">

        {# Section One: Channel List #}
        <section class="channel-list">
            {# Toolbar #}
            <div class="messenger-toolbar"></div>

            {# Search #}
            <div class="search-wrapper">
                <div class="search">
                    <i class="material-icons noselect">search</i>
                    <input class="search-input" type="text" spellcheck="false" placeholder="Search Users">
                </div>
            </div>

            {# Friends/Groups #} <!-- TODO Update with AJAX or Sockets -->
            <!-- Load the 10 most recent channels and refresh frequently -->
            <div class="channel-list-inner">

                {# Channel Template #}
                <a class="chnl-wrapper">
                    <div class="chnl-image"></div>
                    <div class="chnl-info">
                        <p class="chnl-name">Template Channel</p>
                        <div class="last-message-wrapper">
                            <p class="last-message">User: This is the last message that was sent in this channel.</p>
                            <p class="last-message-time">2:30pm</p>
                        </div>
                    </div>
                </a>

                {# Channel Template #}
                <a class="chnl-wrapper" active>
                    <div class="chnl-image"></div>
                    <div class="chnl-info">
                        <p class="chnl-name">Template Channel</p>
                        <div class="last-message-wrapper">
                            <p class="last-message">User: This is the last message that was sent in this channel.</p>
                            <p class="last-message-time">2:30pm</p>
                        </div>
                    </div>
                </a>

            </div>
        </section>


        {# Section Two: Channel Panel #}
        <section class="channel-panel">
            {# Toolbar #}
            <div class="messenger-toolbar">
                {% if channel_id == None %}
                    <p class="no-channel">No Channel Selected</p>
                {% elif is_group %}
                    <p class="channel-title">{{ chat_title }}</p>
                {% else %}
                    <p class="channel-username">{{ chat_title }}</p>
                    <input class="channel-nickname" type="text">
                {% endif %}
            </div>

            {# Messenger Body #}
            <div class="messenger-body"></div>

            {# Messenger Footer #}
            <div class="messenger-footer">

                {# Messenger Input #}
                <div class="messenger-input-wrapper">
                    <p class="messenger-input-placeholder">Enter a message...</p>
                    <div class="messenger-input" contenteditable></div>
                </div>

                {# Messenger Tools #}
                <div class="messenger-tool tooltip-trigger">
                    <i class="material-icons noselect">image</i>
                    <div class="tooltip-container" data-above><p class="tooltip">Attach Image... (Coming Soon)</p></div>
                </div>

                <div class="messenger-tool tooltip-trigger">
                    <i class="material-icons noselect">attach_file</i>
                    <div class="tooltip-container" data-above><p class="tooltip">Attach File... (Coming Soon)</p></div>
                </div>

                <!-- TODO Emoji and improve aesthetics of input -->
            </div>
        </section>


        {# Section Three: Channel Info #}
        <section class="channel-info">
            {# Toolbar #}
            <div class="messenger-toolbar"></div>

            <!-- TODO Allow this to be PJAXed and AJAXed -->
            {% if is_group %}
                {# Channel Title and Type #}

                {# Channel URL #}

                {# Channel Image #}

                {# Channel Moderators #}

                {# Channel Members (If not too large) #}

                {# Creator Info and Date #}
            {% else %}
                {# Username and Nickname #}

                {# User Tags and Achievements (In a Modal) #}

                {# User Image #}

                {# User Bio #}

                {# User Links #}

                {# Friend Status #}

                {# Private Message (If not in private message) #}
            {% endif %}
        </section>

    </div>
{% endblock %}
